{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/ariet/project/pizza_shop/src/components/LoginPopup.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport { useForm } from 'react-hook-form';\nimport personalAreaImg from '../assets/img/personal.png';\nimport { logoutUser, loginUser, loginUserFailure, loginUserSuccess } from '../redux/actions/user';\n\nfunction LoginPopup() {\n  _s();\n\n  const {\n    user,\n    isAuth\n  } = useSelector(({\n    userReducer\n  }) => userReducer);\n  const [visiblePopup, setVisiblePopup] = React.useState(false);\n  const {\n    register,\n    errors,\n    handleSubmit\n  } = useForm();\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  const onHandleSumbit = values => {\n    dispatch(loginUser(values)).then(({\n      data\n    }) => {\n      localStorage.setItem('token', JSON.stringify(data.auth_token));\n      dispatch(loginUserSuccess(data));\n      setVisiblePopup(false);\n      history.push('/account');\n    }).catch(err => {\n      dispatch(loginUserFailure(err.message));\n    });\n  };\n\n  const logoutButton = () => {\n    localStorage.removeItem('token');\n    dispatch(logoutUser());\n    setVisiblePopup(false);\n    history.push('/signup');\n  };\n\n  const loginRef = React.useRef();\n\n  const toggleVisiblePopup = () => {\n    setVisiblePopup(!visiblePopup);\n  };\n\n  const handleOutsideClick = event => {\n    if (!event.path.includes(loginRef.current)) {\n      setVisiblePopup(false);\n    }\n  };\n\n  React.useEffect(() => {\n    document.body.addEventListener('click', handleOutsideClick);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"personal\",\n    ref: loginRef,\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      onClick: toggleVisiblePopup,\n      width: \"50px\",\n      alt: \"img-login\",\n      src: personalAreaImg\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), visiblePopup ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"popup\",\n      children: isAuth ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"popup\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"popup__list\",\n          children: [/*#__PURE__*/_jsxDEV(Link, {\n            to: \"/account\",\n            children: \"\\u041B\\u0438\\u0447\\u043D\\u044B\\u0439 \\u043A\\u0430\\u0431\\u0438\\u043D\\u0435\\u0442\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/edit\",\n            children: \"\\u0420\\u0435\\u0434\\u043E\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: logoutButton,\n            children: \" \\u0412\\u044B\\u0439\\u0442\\u0438 \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"\\u0412\\u043F\\u0435\\u0440\\u0432\\u044B\\u0435 \\u0443 \\u043D\\u0430\\u0441? \", /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/signup\",\n          children: \"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 30\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }, this) : '']\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n}\n\n_s(LoginPopup, \"6G4y9YINMaiRgWBMVNOho8CHqNk=\", false, function () {\n  return [useSelector, useForm, useDispatch, useHistory];\n});\n\n_c = LoginPopup;\nexport default LoginPopup;\n\nvar _c;\n\n$RefreshReg$(_c, \"LoginPopup\");","map":{"version":3,"sources":["/home/ariet/project/pizza_shop/src/components/LoginPopup.js"],"names":["React","Link","useDispatch","useSelector","useHistory","useForm","personalAreaImg","logoutUser","loginUser","loginUserFailure","loginUserSuccess","LoginPopup","user","isAuth","userReducer","visiblePopup","setVisiblePopup","useState","register","errors","handleSubmit","dispatch","history","onHandleSumbit","values","then","data","localStorage","setItem","JSON","stringify","auth_token","push","catch","err","message","logoutButton","removeItem","loginRef","useRef","toggleVisiblePopup","handleOutsideClick","event","path","includes","current","useEffect","document","body","addEventListener"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { useHistory } from 'react-router-dom';\nimport { useForm } from 'react-hook-form';\n\nimport personalAreaImg from '../assets/img/personal.png';\nimport { logoutUser, loginUser, loginUserFailure, loginUserSuccess } from '../redux/actions/user';\n\nfunction LoginPopup() {\n  const { user, isAuth } = useSelector(({ userReducer }) => userReducer);\n  const [visiblePopup, setVisiblePopup] = React.useState(false);\n\n  const { register, errors, handleSubmit } = useForm();\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  const onHandleSumbit = (values) => {\n    dispatch(loginUser(values))\n      .then(({ data }) => {\n        localStorage.setItem('token', JSON.stringify(data.auth_token));\n        dispatch(loginUserSuccess(data));\n        setVisiblePopup(false);\n        history.push('/account');\n      })\n      .catch((err) => {\n        dispatch(loginUserFailure(err.message));\n      });\n  };\n\n  const logoutButton = () => {\n    localStorage.removeItem('token');\n    dispatch(logoutUser());\n    setVisiblePopup(false);\n    history.push('/signup');\n  };\n\n  const loginRef = React.useRef();\n\n  const toggleVisiblePopup = () => {\n    setVisiblePopup(!visiblePopup);\n  };\n\n  const handleOutsideClick = (event) => {\n    if (!event.path.includes(loginRef.current)) {\n      setVisiblePopup(false);\n    }\n  };\n\n  React.useEffect(() => {\n    document.body.addEventListener('click', handleOutsideClick);\n  }, []);\n\n  return (\n    <div className=\"personal\" ref={loginRef}>\n      <img onClick={toggleVisiblePopup} width=\"50px\" alt=\"img-login\" src={personalAreaImg} />\n      {visiblePopup ? (\n        <div className=\"popup\">\n          {isAuth ? (\n            <div className=\"popup\">\n              <div className=\"popup__list\">\n                <Link to=\"/account\">Личный кабинет</Link>\n                <Link to=\"/edit\">Редоктировать</Link>\n                <button onClick={logoutButton}> Выйти </button>\n              </div>\n            </div>\n          ) : (\n            <p>\n              Впервые у нас? <Link to=\"/signup\">Зарегистрироваться</Link>\n            </p>\n          )}\n        </div>\n      ) : (\n        ''\n      )}\n    </div>\n  );\n}\n\nexport default LoginPopup;\n"]},"metadata":{},"sourceType":"module"}